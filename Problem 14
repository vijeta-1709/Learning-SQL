WITH employee_query_counts AS (
    SELECT 
        e.employee_id,
        COUNT(DISTINCT q.query_id) AS unique_query_count
    FROM employees e
    LEFT JOIN queries q
      ON e.employee_id = q.employee_id
     AND q.query_starttime BETWEEN DATE '2023-07-01' AND DATE '2023-10-1'
    GROUP BY e.employee_id
)
SELECT 
    unique_query_count,
    COUNT(*) AS employee_count
FROM employee_query_counts
GROUP BY unique_query_count
ORDER BY unique_query_count;
